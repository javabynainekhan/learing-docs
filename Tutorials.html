<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code with Julkhair | ðŸ‘‹</title>
    <link rel="icon" type="image/x-icon" href="./coding.png" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/github-markdown-css/github-markdown.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
      .markdown-body pre {
        background-color: #f7f7f7;
        padding: 15px;
        border-radius: 5px;
      }
      .markdown-body {
        transition: all 0.3s ease;
      }
      .toc a {
        display: block;
        padding: 4px 0px 4px 10px;
        color: #fff;
        text-transform: capitalize;
        transition: all 0.2s ease;
      }
      .toc a:hover {
        color: #fff;
      }
      .active {
        width: 100%; /* Tailwind Green */
        color: blue;
        font-weight: bold;
        border-radius: 12px;
        border: 2px sold;
        padding: 10px;
      }
      .nav-item {
        padding: 0.5rem 1rem;
        transition: color 0.3s;
      }
    </style>
  </head>
  <body class="bg-gray-100 text-gray-900 font-sans w-full">
    <header
      class="shadow-lg isolate h-16 border-b bg-transparent ring-1 ring-black/5"
    >
      <nav class="flex justify-between items-center p-4">
        <a href="index.html" class="flex items-center gap-2">
          <img src="./coding.png" alt="Coding" class="w-10 h-10" />
          <p
            class="text-2xl font-bold bg-gradient-to-b from-red-400 to-blue-500 bg-clip-text text-transparent"
          >
            Julkhair
          </p>
        </a>

        <!-- Mobile menu button -->
        <div class="sm:hidden flex items-center">
          <button id="menu-toggle" class="text-xl">â˜°</button>
        </div>

        <!-- Desktop Navbar -->
        <ul class="hidden sm:flex gap-6 items-center font-medium">
          <li>
            <a href="index.html" class="nav-item transition hover:text-blue-500"
              >Home</a
            >
          </li>
          <li>
            <a href="About.html" class="nav-item transition hover:text-blue-500"
              >About</a
            >
          </li>
          <li>
            <a
              href="Contact.html"
              class="nav-item transition hover:text-blue-500"
              >Contact</a
            >
          </li>
          <li>
            <a
              href="Tutorials.html"
              class="nav-item transition hover:text-blue-500"
              >Tutorials</a
            >
          </li>
        </ul>

        <!-- Mobile Navbar -->
        <ul
          id="mobile-navbar"
          class="sm:hidden fixed inset-0 shadow-lg bg-white bg-opacity-90 ring-1 ring-black/5 isolate p-4 flex flex-col items-center gap-2 hidden"
        >
          <div class="flex justify-between gap-2 w-full">
            <a href="index.html" class="flex items-center gap-2 w-full">
              <img src="./coding.png" alt="Coding" class="w-10 h-10" />
              <p
                class="text-2xl font-bold bg-gradient-to-b from-red-400 to-blue-500 bg-clip-text text-transparent"
              >
                Julkhair
              </p>
            </a>
            <!-- Close Button -->
            <div class="flex justify-end w-full">
              <button id="close-btn" class="text-3xl">Ã—</button>
            </div>
          </div>
          <li
            class="w-full p-3 rounded-xl hover:bg-green-400 hover:text-blue-600 hover:font-bold"
          >
            <a href="index.html" class="text-lg w-full block nav-item">Home</a>
          </li>
          <li
            class="w-full p-3 rounded-xl hover:bg-green-400 hover:text-blue-600 hover:font-bold"
          >
            <a href="About.html" class="text-lg w-full block nav-item">About</a>
          </li>
          <li
            class="w-full p-3 rounded-xl hover:bg-green-400 hover:text-blue-600 hover:font-bold"
          >
            <a href="Contact.html" class="text-lg w-full block nav-item"
              >Contact</a
            >
          </li>
          <li
            class="w-full p-3 rounded-xl hover:bg-green-400 hover:text-blue-600 hover:font-bold"
          >
            <a href="Tutorials.html" class="text-lg w-full block nav-item"
              >Tutorials</a
            >
          </li>
        </ul>
      </nav>
    </header>
    <!-- Mobile Toggle -->
    <section>
      <button
        id="mobile-sidebar-toggle"
        class="md:hidden absolute top-20 right-2 z-10 bg-gray-800 text-white px-3 py-2 rounded"
        onclick="sidebar.classList.toggle('hidden')"
      >
        â˜°
      </button>

      <div
        class="flex flex-col md:flex-row h-[calc(100vh-64px)] overflow-hidden"
      >
        <!-- Left Sidebar -->
        <div
          id="sidebar"
          class="w-full md:w-[20%] hidden md:block bg-gray-800 text-white p-4 border-b md:border-b-0 md:border-r border-gray-700"
        >
          <h3 class="text-xl font-semibold mb-4">Markdown Files</h3>
          <div id="fileList" class="space-y-2"></div>
        </div>

        <!-- Content Area -->
        <div class="flex overflow-hidden w-full">
          <div
            id="content"
            class="markdown-body w-full p-6 overflow-y-auto flex-grow"
          ></div>

          <!-- TOC Sidebar, hidden on mobile -->
          <div
            id="toc"
            class="hidden md:block w-1/2 p-3 overflow-y-auto border-gray-300 bg-gray-800 toc"
          ></div>
        </div>
      </div>
    </section>

    <script>
      const files = ["reading.md", "Basics of react.md"];
      const menuButton = document.getElementById("menu-toggle");
      const mobileNavbar = document.getElementById("mobile-navbar");
      const closeButton = document.getElementById("close-btn");
      const fileList = document.getElementById("fileList");
      const contentDiv = document.getElementById("content");
      const sidebar = document.getElementById("sidebar");
      const tocDiv = document.getElementById("toc");
      const mobileSidebarToggle = document.getElementById(
        "mobile-sidebar-toggle"
      );

      let currentActive = null;

      files.forEach((filename) => {
        const item = document.createElement("div");
        item.textContent = filename.split(".")[0];
        item.className =
          "cursor-pointer bg-gray-700 hover:bg-teal-500 px-4 py-2 rounded capitalize";
        item.addEventListener("click", () => {
          if (currentActive) {
            currentActive.classList.remove(
              "bg-teal-600",
              "ring",
              "ring-teal-300"
            );
            currentActive.classList.add("bg-gray-700");
          }

          item.classList.remove("bg-gray-700");
          item.classList.add("bg-teal-600", "ring", "ring-teal-300");
          currentActive = item;

          loadMarkdown(filename);
        });

        fileList.appendChild(item);
      });

      function loadMarkdown(filename) {
        fetch(`markdown/${filename}`)
          .then((res) => {
            if (!res.ok) throw new Error(`Failed to load ${filename}`);
            return res.text();
          })
          .then((md) => {
            const html = marked.parse(md);
            contentDiv.innerHTML = html;
            hljs.highlightAll();
            generateTOC(); // Generate TOC after loading Markdown
          })
          .catch((err) => {
            contentDiv.innerHTML = `<p class="text-red-500">${err.message}</p>`;
            tocDiv.innerHTML = "";
            tocDiv.classList.add("hidden"); // Hide TOC if file fails to load
          });
      }

      let currentTOCActive = null;

      function generateTOC() {
        const headings = contentDiv.querySelectorAll("h1, h2, h3");

        // If no headings found, hide TOC
        if (headings.length === 0) {
          tocDiv.classList.add("hidden");
          return;
        }

        tocDiv.classList.remove("hidden");
        tocDiv.innerHTML =
          "<h2 class='text-lg font-semibold mb-2 text-white'>Table of Contents</h2>";

        headings.forEach((heading, index) => {
          const id = `heading-${index}`;
          heading.id = id;

          const link = document.createElement("a");
          link.href = `#${id}`;
          link.textContent = heading.textContent;
          link.className = `pl-${
            (parseInt(heading.tagName[1]) - 1) * 4
          } text-sm cursor-pointer hover:bg-teal-500 p-4 rounded capitalize`;

          link.addEventListener("click", (e) => {
            if (currentTOCActive) {
              currentTOCActive.classList.remove(
                "bg-teal-600",
                "ring",
                "ring-teal-300",
                "text-white"
              );
            }
            link.classList.add(
              "bg-teal-600",
              "ring",
              "ring-teal-300",
              "text-white"
            );
            currentTOCActive = link;
          });

          tocDiv.appendChild(link);
        });
      }

      // Show the mobile menu when the hamburger button is clicked
      menuButton.addEventListener("click", () => {
        mobileNavbar.classList.remove("hidden");
        mobileSidebarToggle.classList.add("hidden"); // Hides the â˜° sidebar toggle button
      });

      // Close the mobile menu when the close button is clicked
      closeButton.addEventListener("click", () => {
        mobileNavbar.classList.add("hidden");
        mobileSidebarToggle.classList.remove("hidden"); // Shows the â˜° sidebar toggle button again
      });

      // Set active class on current page in both desktop and mobile nav
      function setActiveNav() {
        const navLinks = document.querySelectorAll(".nav-item");
        const currentPage = window.location.pathname.split("/").pop(); // Get the current page name from the URL

        navLinks.forEach((link) => {
          if (link.href.includes(currentPage)) {
            link.classList.add("active"); // Add active class to the current page
          } else {
            link.classList.remove("active"); // Remove active class from others
          }
        });
      }

      // Run the function to set active navigation link
      setActiveNav();

      // Responsive Sidebar Behavior
      function handleResponsiveSidebar() {
        if (window.innerWidth < 768) {
          sidebar.classList.add("hidden");
          tocDiv.classList.add("hidden"); // Hide TOC when on mobile
        } else {
          sidebar.classList.remove("hidden");
          if (contentDiv.querySelectorAll("h1, h2, h3").length > 0) {
            tocDiv.classList.remove("hidden"); // Show TOC if headings are present
          }
        }
      }

      window.addEventListener("DOMContentLoaded", handleResponsiveSidebar);
      window.addEventListener("resize", handleResponsiveSidebar);
    </script>
  </body>
</html>
